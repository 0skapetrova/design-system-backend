# ๐งญ ะัะธะปะพะถะตะฝะธะต: CJS vs ESM ะฒ Node.js (ัะฟะฐัะณะฐะปะบะฐ + ัะพะฑะตัะตะดะพะฒะฐะฝะธั)

### ๐ฆ 1. ะะฒะฐ ัะพัะผะฐัะฐ ะผะพะดัะปะตะน ะฒ Node

**CommonJS (CJS)**
- ะะผะฟะพัั / ัะบัะฟะพัั: `require`, `module.exports`
- ะะฐััะธัะตะฝะธั: `.js`, `.cjs`
- ะฃะบะฐะทัะฒะฐะตััั ะฒ package.json: `"type": "commonjs"` ะธะปะธ ะฟะพะปะต ะพััััััะฒัะตั

**ES Modules (ESM)**
- ะะผะฟะพัั / ัะบัะฟะพัั: `import`, `export`
- ะะฐััะธัะตะฝะธั: `.mjs`, `.js`
- ะฃะบะฐะทัะฒะฐะตััั ะฒ package.json: `"type": "module"`

Node ะพะฟัะตะดะตะปัะตั ะฟะพะฒะตะดะตะฝะธะต ะฟะพ `package.json` ะธะปะธ ะฟะพ ัะฐััะธัะตะฝะธั ัะฐะนะปะฐ.

---

### โ๏ธ 2. ะะฐัััะพะนะบะธ TypeScript

#### ESM (ัะพะฒัะตะผะตะฝะฝัะน ััะตะบ)
```json
{
  "compilerOptions": {
    "module": "NodeNext",
    "moduleResolution": "NodeNext",
    "target": "ES2022"
  }
}
```
ะ `package.json`:
```json
{ "type": "module" }
```

#### CJS (ะปะตะณะฐัะธ/ััะธะปะธัั)
```json
{
  "compilerOptions": {
    "module": "CommonJS",
    "target": "ES2020"
  }
}
```
ะ `package.json`:
```json
{ "type": "commonjs" }
```

---

### ๐ 3. ะะทะฐะธะผะพะดะตะนััะฒะธะต ัะพัะผะฐัะพะฒ (interop)

**ะัะฟะพะปัะทะพะฒะฐัั CJS ะฒ ESM**
```ts
import { createRequire } from 'node:module';
const require = createRequire(import.meta.url);
const pkg = require('some-cjs-package');
```

**ะัะฟะพะปัะทะพะฒะฐัั ESM ะฒ CJS**
```js
(async () => {
  const esm = await import('./modern.mjs');
  esm.default();
})();
```

**ะกะผะตัะฐะฝะฝัะต ัะฐะนะปั**
- `.mjs` โ ESM ะดะฐะถะต ะฒ CJS-ะฟัะพะตะบัะต  
- `.cjs` โ CJS ะดะฐะถะต ะฒ ESM-ะฟัะพะตะบัะต

---

### ๐งช 4. ะะธะฝะธ-ะฟัะฐะบัะธะบะฐ

**CJS โ ESM**
```js
// legacy.cjs
module.exports = (n) => `Hello, ${n}`;

// use_legacy.ts
import { createRequire } from 'node:module';
const require = createRequire(import.meta.url);
const greet = require('./legacy.cjs');
console.log(greet('Olya'));
```

**ESM โ CJS**
```js
// modern.mjs
export default (x) => x.toUpperCase();

// demo.cjs
(async () => {
  const mod = await import('./modern.mjs');
  console.log(mod.default('design-system'));
})();
```

---

### ๐ฌ 5. ะะฐะบ ััะพ ัะฟัะฐัะธะฒะฐัั ะฝะฐ ัะพะฑะตัะตะดะพะฒะฐะฝะธะธ

**ะัะธะผะตัั ะฒะพะฟัะพัะพะฒ:**
- ๐ข Junior โ ะะพัะตะผั `Cannot use import statement outside a module`?  
  โ ะัะพะฒะตัััั ะฟะพะฝะธะผะฐะฝะธะต ัะฐะทะฝะธัั CJS ะธ ESM.
- ๐ข Junior โ ะงัะพ ะดะตะปะฐะตั `"type": "module"`?  
  โ ะัะพะฒะตัััั ะทะฝะฐะฝะธะต ะผะตัะฐะฝะธะทะผะฐ ะฒัะฑะพัะฐ ัะพัะผะฐัะฐ.
- ๐ก Junior+ โ ะะพะถะฝะพ ะปะธ ะฒ ESM ะธัะฟะพะปัะทะพะฒะฐัั require?  
  โ ะัะพะฒะตัััั ะฟะพะฝะธะผะฐะฝะธะต interop.
- ๐ก Middle โ ะงะตะผ `module.exports` ะพัะปะธัะฐะตััั ะพั `export default`?  
  โ ะัะพะฒะตัััั ะทะฝะฐะฝะธะต ะฟะพะฒะตะดะตะฝะธั ัะบัะฟะพััะฐ.
- ๐ Middle โ ะะฐะบ ะพะฟัะฑะปะธะบะพะฒะฐัั ะฟะฐะบะตั, ะฟะพะดะดะตัะถะธะฒะฐััะธะน ะพะฑะฐ ัะพัะผะฐัะฐ?  
  โ ะัะพะฒะตัััั ะฐััะธัะตะบัััะฝะพะต ะผััะปะตะฝะธะต.

๐งฉ ะะปะฐะฒะฝะพะต โ ัะผะตัั ะพะฑัััะฝะธัั:  
> Node ะธะผะตะตั ะดะฒะฐ ัะพัะผะฐัะฐ ะผะพะดัะปะตะน, ะธ `package.json โ "type"` ะพะฟัะตะดะตะปัะตั, ะบะฐะบะพะน ะธัะฟะพะปัะทะพะฒะฐัั.  
> TypeScript ััะตะฑัะตั ัะพะณะปะฐัะพะฒะฐะฝะฝัั ะพะฟัะธะน (`module` / `moduleResolution`) ะดะปั ะฟัะฐะฒะธะปัะฝะพะน ะบะพะผะฟะธะปััะธะธ.

---

๐ **ะะตะทัะผะต:**
- ะะพะฒัะน ะฟัะพะตะบั โ ESM (`type: module`, `NodeNext`).  
- ะะตะณะฐัะธ / ัะบัะธะฟัั โ CJS (`require`).  
- ะะฝัะตัะพะฟ ัะตัะฐะตััั ัะตัะตะท `createRequire` ะธะปะธ `await import()`.  
- ะะฐ ัะพะฑะตัะตะดะพะฒะฐะฝะธะธ ัะตะฝัั ะฝะต ัะธะฝัะฐะบัะธั, ะฐ ะฟะพะฝะธะผะฐะฝะธะต โ *ะฟะพัะตะผั ะธ ะบะฐะบ ััะพ ัะฐะฑะพัะฐะตั*.

---

### ๐งฉ ะะฝัะตัะฒััโัะตะบะปะธัั (2 ะผะธะฝััั ะฟะตัะตะด ัะพะฑะตัะพะผ)

1. ะ ััะผ ัะฐะทะฝะธัะฐ ะผะตะถะดั `require` ะธ `import`?  
2. ะงัะพ ะดะตะปะฐะตั ะฟะพะปะต `"type": "module"`?  
3. ะะพัะตะผั ะฟัะธ ะธะผะฟะพััะต ะผะพะถะตั ะฟะพัะฒะธัััั ะพัะธะฑะบะฐ โCannot use import statement outside a moduleโ?  
4. ะะฐะบ ะธัะฟะพะปัะทะพะฒะฐัั ะฑะธะฑะปะธะพัะตะบั, ะฝะฐะฟะธัะฐะฝะฝัั ะฒ CJS, ะฒ ESMโะฟัะพะตะบัะต?  
5. ะะฐะบ ะฒะบะปััะธัั ESMโัะตะถะธะผ ะฒ TypeScript?  
6. ะะพะณะดะฐ ะปัััะต ะพััะฐะฒะธัั CommonJS?

> ๐น ะฆะตะปั: ะพะฑัััะฝะธัั ัะฒะพะธะผะธ ัะปะพะฒะฐะผะธ, ะฐ ะฝะต ะฒัััะธัั ัะพัะผัะปะธัะพะฒะบั.  
> ๐น ะัะฐะผะพัะฝัะน ะธะฝะถะตะฝะตั ะฒัะตะณะดะฐ ะณะพะฒะพัะธั: โะะฑะฐ ัะพัะผะฐัะฐ ัััะตััะฒััั. ESM โ ััะฐะฝะดะฐัั, CJS โ ะดะปั ะพะฑัะฐัะฝะพะน ัะพะฒะผะตััะธะผะพััะธ.โ
